{"id":"xFSo","dependencies":[{"name":"/Users/hk/Sites/digital-forest-monitoring/package.json","includedInParent":true,"mtime":1574333047455},{"name":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/package.json","includedInParent":true,"mtime":1573122283680},{"name":"../ImageCanvas.js","loc":{"line":17,"column":24},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Raster.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/ImageCanvas.js"},{"name":"../TileQueue.js","loc":{"line":18,"column":22},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Raster.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/TileQueue.js"},{"name":"../dom.js","loc":{"line":19,"column":38},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Raster.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/dom.js"},{"name":"../events/Event.js","loc":{"line":20,"column":18},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Raster.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/events/Event.js"},{"name":"../events/EventType.js","loc":{"line":21,"column":22},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Raster.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/events/EventType.js"},{"name":"pixelworks/lib/index.js","loc":{"line":22,"column":26},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Raster.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/pixelworks/lib/index.js"},{"name":"../extent.js","loc":{"line":23,"column":55},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Raster.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/extent.js"},{"name":"../layer/Image.js","loc":{"line":24,"column":23},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Raster.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/layer/Image.js"},{"name":"../layer/Tile.js","loc":{"line":25,"column":22},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Raster.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/layer/Tile.js"},{"name":"../obj.js","loc":{"line":26,"column":23},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Raster.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/obj.js"},{"name":"../transform.js","loc":{"line":27,"column":42},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Raster.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/transform.js"},{"name":"./Image.js","loc":{"line":28,"column":24},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Raster.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Image.js"},{"name":"./Tile.js","loc":{"line":29,"column":23},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Raster.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Tile.js"},{"name":"./State.js","loc":{"line":30,"column":24},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Raster.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/State.js"},{"name":"./Source.js","loc":{"line":31,"column":19},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Raster.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/Source.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=exports.RasterSourceEvent=void 0;var e=v(require(\"../ImageCanvas.js\")),t=v(require(\"../TileQueue.js\")),r=require(\"../dom.js\"),n=v(require(\"../events/Event.js\")),a=v(require(\"../events/EventType.js\")),i=require(\"pixelworks/lib/index.js\"),o=require(\"../extent.js\"),s=v(require(\"../layer/Image.js\")),u=v(require(\"../layer/Tile.js\")),l=require(\"../obj.js\"),d=require(\"../transform.js\"),c=v(require(\"./Image.js\")),h=v(require(\"./Tile.js\")),f=v(require(\"./State.js\")),p=v(require(\"./Source.js\"));function v(e){return e&&e.__esModule?e:{default:e}}var g=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),_={BEFOREOPERATIONS:\"beforeoperations\",AFTEROPERATIONS:\"afteroperations\"},m={PIXEL:\"pixel\",IMAGE:\"image\"},y=function(e){function t(t,r,n){var a=e.call(this,t)||this;return a.extent=r.extent,a.resolution=r.viewState.resolution/r.pixelRatio,a.data=n,a}return g(t,e),t}(n.default);exports.RasterSourceEvent=y;var S=function(n){function s(e){var r=n.call(this,{projection:null})||this;r.worker_=null,r.operationType_=void 0!==e.operationType?e.operationType:m.PIXEL,r.threads_=void 0!==e.threads?e.threads:1,r.layers_=E(e.sources);for(var i=r.changed.bind(r),o=0,s=r.layers_.length;o<s;++o)r.layers_[o].addEventListener(a.default.CHANGE,i);return r.tileQueue_=new t.default(function(){return 1},r.changed.bind(r)),r.requestedFrameState_,r.renderedImageCanvas_=null,r.renderedRevision_,r.frameState_={animate:!1,coordinateToPixelTransform:(0,d.create)(),extent:null,index:0,layerIndex:0,layerStatesArray:x(r.layers_),pixelRatio:1,pixelToCoordinateTransform:(0,d.create)(),postRenderFunctions:[],size:[0,0],tileQueue:r.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},declutterItems:[]},r.setAttributions(function(t){for(var r=[],n=0,a=e.sources.length;n<a;++n){var i=e.sources[n],o=(i instanceof p.default?i:i.getSource()).getAttributions();if(\"function\"==typeof o){var s=o(t);r.push.apply(r,s)}}return 0!==r.length?r:null}),void 0!==e.operation&&r.setOperation(e.operation,e.lib),r}return g(s,n),s.prototype.setOperation=function(e,t){this.worker_=new i.Processor({operation:e,imageOps:this.operationType_===m.IMAGE,queue:1,lib:t,threads:this.threads_}),this.changed()},s.prototype.updateFrameState_=function(e,t,r){var n=(0,l.assign)({},this.frameState_);n.viewState=(0,l.assign)({},n.viewState);var a=(0,o.getCenter)(e);n.extent=e.slice(),n.size[0]=Math.round((0,o.getWidth)(e)/t),n.size[1]=Math.round((0,o.getHeight)(e)/t),n.time=1/0;var i=n.viewState;return i.center=a,i.projection=r,i.resolution=t,n},s.prototype.allSourcesReady_=function(){for(var e=!0,t=0,r=this.layers_.length;t<r;++t)if(this.layers_[t].getSource().getState()!==f.default.READY){e=!1;break}return e},s.prototype.getImage=function(e,t,r,n){if(!this.allSourcesReady_())return null;var a=this.updateFrameState_(e,t,n);if(this.requestedFrameState_=a,this.renderedImageCanvas_){var i=this.renderedImageCanvas_.getResolution(),s=this.renderedImageCanvas_.getExtent();t===i&&(0,o.equals)(e,s)||(this.renderedImageCanvas_=null)}return this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),a.tileQueue.loadMoreTiles(16,16),a.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_},s.prototype.processSources_=function(){for(var e=this.requestedFrameState_,t=this.layers_.length,r=new Array(t),n=0;n<t;++n){e.layerIndex=n;var a=I(this.layers_[n],e);if(!a)return;r[n]=a}var i={};this.dispatchEvent(new y(_.BEFOREOPERATIONS,e,i)),this.worker_.process(r,i,this.onWorkerComplete_.bind(this,e))},s.prototype.onWorkerComplete_=function(t,n,a,i){if(!n&&a){var s=t.extent,u=t.viewState.resolution;if(u===this.requestedFrameState_.viewState.resolution&&(0,o.equals)(s,this.requestedFrameState_.extent)){var l;if(this.renderedImageCanvas_)l=this.renderedImageCanvas_.getImage().getContext(\"2d\");else{var d=Math.round((0,o.getWidth)(s)/u),c=Math.round((0,o.getHeight)(s)/u);l=(0,r.createCanvasContext2D)(d,c),this.renderedImageCanvas_=new e.default(s,u,1,l.canvas)}l.putImageData(a,0,0),this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new y(_.AFTEROPERATIONS,t,i))}}},s.prototype.getImageInternal=function(){return null},s}(c.default),w=null;function I(e,t){var n=e.getRenderer();if(!n)throw new Error(\"Unsupported layer type: \"+e);if(!n.prepareFrame(t))return null;var a,i=t.size[0],o=t.size[1],s=n.renderFrame(t,null);if(s&&(a=s.firstElementChild),!(a instanceof HTMLCanvasElement))throw new Error(\"Unsupported rendered element: \"+a);if(a.width===i&&a.height===o)return a.getContext(\"2d\").getImageData(0,0,i,o);if(w){var u=w.canvas;u.width!==i||u.height!==o?w=(0,r.createCanvasContext2D)(i,o):w.clearRect(0,0,i,o)}else w=(0,r.createCanvasContext2D)(i,o);return w.drawImage(a,0,0,i,o),w.getImageData(0,0,i,o)}function x(e){return e.map(function(e){return e.getLayerState()})}function E(e){for(var t=e.length,r=new Array(t),n=0;n<t;++n)r[n]=C(e[n]);return r}function C(e){var t;return e instanceof p.default?e instanceof h.default?t=new u.default({source:e}):e instanceof c.default&&(t=new s.default({source:e})):t=e,t}var q=S;exports.default=q;"},"sourceMaps":null,"error":null,"hash":"004879214857e9f4a8989105b2d09944","cacheData":{"env":{}}}