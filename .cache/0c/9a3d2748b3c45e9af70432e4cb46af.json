{"id":"jMDC","dependencies":[{"name":"/Users/hk/Sites/digital-forest-monitoring/package.json","includedInParent":true,"mtime":1574333047455},{"name":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/package.json","includedInParent":true,"mtime":1573122283680},{"name":"../util.js","loc":{"line":17,"column":23},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/interaction/Snap.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/util.js"},{"name":"../CollectionEventType.js","loc":{"line":18,"column":32},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/interaction/Snap.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/CollectionEventType.js"},{"name":"../coordinate.js","loc":{"line":19,"column":154},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/interaction/Snap.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/coordinate.js"},{"name":"../events.js","loc":{"line":20,"column":38},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/interaction/Snap.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/events.js"},{"name":"../events/EventType.js","loc":{"line":21,"column":22},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/interaction/Snap.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/events/EventType.js"},{"name":"../extent.js","loc":{"line":22,"column":44},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/interaction/Snap.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/extent.js"},{"name":"../functions.js","loc":{"line":23,"column":28},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/interaction/Snap.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/functions.js"},{"name":"../geom/GeometryType.js","loc":{"line":24,"column":25},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/interaction/Snap.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/geom/GeometryType.js"},{"name":"../geom/Polygon.js","loc":{"line":25,"column":27},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/interaction/Snap.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/geom/Polygon.js"},{"name":"./Pointer.js","loc":{"line":26,"column":31},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/interaction/Snap.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/interaction/Pointer.js"},{"name":"../obj.js","loc":{"line":27,"column":26},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/interaction/Snap.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/obj.js"},{"name":"../source/VectorEventType.js","loc":{"line":28,"column":28},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/interaction/Snap.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/source/VectorEventType.js"},{"name":"../structs/RBush.js","loc":{"line":29,"column":18},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/interaction/Snap.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/structs/RBush.js"},{"name":"../proj.js","loc":{"line":30,"column":53},"parent":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/interaction/Snap.js","resolved":"/Users/hk/Sites/digital-forest-monitoring/node_modules/ol/proj.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var e=require(\"../util.js\"),t=p(require(\"../CollectionEventType.js\")),r=require(\"../coordinate.js\"),n=require(\"../events.js\"),i=p(require(\"../events/EventType.js\")),o=require(\"../extent.js\"),s=require(\"../functions.js\"),a=p(require(\"../geom/GeometryType.js\")),u=require(\"../geom/Polygon.js\"),l=p(require(\"./Pointer.js\")),h=require(\"../obj.js\"),d=p(require(\"../source/VectorEventType.js\")),f=p(require(\"../structs/RBush.js\")),g=require(\"../proj.js\");function p(e){return e&&e.__esModule?e:{default:e}}var c=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function _(e){return e.feature?e.feature:e.element?e.element:void 0}var v=[],y=function(l){function p(e){var t=this,r=e||{},n=r;return n.handleDownEvent||(n.handleDownEvent=s.TRUE),n.stopDown||(n.stopDown=s.FALSE),(t=l.call(this,n)||this).source_=r.source?r.source:null,t.vertex_=void 0===r.vertex||r.vertex,t.edge_=void 0===r.edge||r.edge,t.features_=r.features?r.features:null,t.featuresListenerKeys_=[],t.featureChangeListenerKeys_={},t.indexedFeaturesExtents_={},t.pendingFeatures_={},t.pixelTolerance_=void 0!==r.pixelTolerance?r.pixelTolerance:10,t.rBush_=new f.default,t.SEGMENT_WRITERS_={Point:t.writePointGeometry_.bind(t),LineString:t.writeLineStringGeometry_.bind(t),LinearRing:t.writeLineStringGeometry_.bind(t),Polygon:t.writePolygonGeometry_.bind(t),MultiPoint:t.writeMultiPointGeometry_.bind(t),MultiLineString:t.writeMultiLineStringGeometry_.bind(t),MultiPolygon:t.writeMultiPolygonGeometry_.bind(t),GeometryCollection:t.writeGeometryCollectionGeometry_.bind(t),Circle:t.writeCircleGeometry_.bind(t)},t}return c(p,l),p.prototype.addFeature=function(t,r){var s=void 0===r||r,a=(0,e.getUid)(t),u=t.getGeometry();if(u){var l=this.SEGMENT_WRITERS_[u.getType()];l&&(this.indexedFeaturesExtents_[a]=u.getExtent((0,o.createEmpty)()),l(t,u))}s&&(this.featureChangeListenerKeys_[a]=(0,n.listen)(t,i.default.CHANGE,this.handleFeatureChange_,this))},p.prototype.forEachFeatureAdd_=function(e){this.addFeature(e)},p.prototype.forEachFeatureRemove_=function(e){this.removeFeature(e)},p.prototype.getFeatures_=function(){var e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e},p.prototype.handleEvent=function(e){var t=this.snapTo(e.pixel,e.coordinate,e.map);return t.snapped&&(e.coordinate=t.vertex.slice(0,2),e.pixel=t.vertexPixel),l.prototype.handleEvent.call(this,e)},p.prototype.handleFeatureAdd_=function(e){var t=_(e);this.addFeature(t)},p.prototype.handleFeatureRemove_=function(e){var t=_(e);this.removeFeature(t)},p.prototype.handleFeatureChange_=function(t){var r=t.target;if(this.handlingDownUpSequence){var n=(0,e.getUid)(r);n in this.pendingFeatures_||(this.pendingFeatures_[n]=r)}else this.updateFeature_(r)},p.prototype.handleUpEvent=function(e){var t=(0,h.getValues)(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1},p.prototype.removeFeature=function(t,r){var i=void 0===r||r,o=(0,e.getUid)(t),s=this.indexedFeaturesExtents_[o];if(s){var a=this.rBush_,u=[];a.forEachInExtent(s,function(e){t===e.feature&&u.push(e)});for(var l=u.length-1;l>=0;--l)a.remove(u[l])}i&&((0,n.unlistenByKey)(this.featureChangeListenerKeys_[o]),delete this.featureChangeListenerKeys_[o])},p.prototype.setMap=function(e){var r=this.getMap(),i=this.featuresListenerKeys_,o=this.getFeatures_();r&&(i.forEach(n.unlistenByKey),i.length=0,o.forEach(this.forEachFeatureRemove_.bind(this))),l.prototype.setMap.call(this,e),e&&(this.features_?i.push((0,n.listen)(this.features_,t.default.ADD,this.handleFeatureAdd_,this),(0,n.listen)(this.features_,t.default.REMOVE,this.handleFeatureRemove_,this)):this.source_&&i.push((0,n.listen)(this.source_,d.default.ADDFEATURE,this.handleFeatureAdd_,this),(0,n.listen)(this.source_,d.default.REMOVEFEATURE,this.handleFeatureRemove_,this)),o.forEach(this.forEachFeatureAdd_.bind(this)))},p.prototype.snapTo=function(e,t,n){var i=n.getCoordinateFromPixel([e[0]-this.pixelTolerance_,e[1]+this.pixelTolerance_]),s=n.getCoordinateFromPixel([e[0]+this.pixelTolerance_,e[1]-this.pixelTolerance_]),u=(0,o.boundingExtent)([i,s]),l=this.rBush_.getInExtent(u);this.vertex_&&!this.edge_&&(l=l.filter(function(e){return e.feature.getGeometry().getType()!==a.default.CIRCLE}));var h=!1,d=null,f=null;if(0===l.length)return{snapped:h,vertex:d,vertexPixel:f};for(var p,c=n.getView().getProjection(),_=(0,g.fromUserCoordinate)(t,c),y=1/0,m=0;m<l.length;++m){var x=l[m];v[0]=(0,g.fromUserCoordinate)(x.segment[0],c),v[1]=(0,g.fromUserCoordinate)(x.segment[1],c);var E=(0,r.squaredDistanceToSegment)(_,v);E<y&&(p=x,y=E)}var F=p.segment;if(this.vertex_&&!this.edge_){var C=n.getPixelFromCoordinate(F[0]),G=n.getPixelFromCoordinate(F[1]),P=(0,r.squaredDistance)(e,C),T=(0,r.squaredDistance)(e,G);Math.sqrt(Math.min(P,T))<=this.pixelTolerance_&&(h=!0,d=P>T?F[1]:F[0],f=n.getPixelFromCoordinate(d))}else if(this.edge_){var w=p.feature.getGeometry().getType()===a.default.CIRCLE;if(w?d=(0,r.closestOnCircle)(t,p.feature.getGeometry()):(v[0]=(0,g.fromUserCoordinate)(F[0],c),v[1]=(0,g.fromUserCoordinate)(F[1],c),d=(0,g.toUserCoordinate)((0,r.closestOnSegment)(_,v),c)),f=n.getPixelFromCoordinate(d),(0,r.distance)(e,f)<=this.pixelTolerance_&&(h=!0,this.vertex_&&!w)){C=n.getPixelFromCoordinate(F[0]),G=n.getPixelFromCoordinate(F[1]),P=(0,r.squaredDistance)(f,C),T=(0,r.squaredDistance)(f,G);Math.sqrt(Math.min(P,T))<=this.pixelTolerance_&&(d=P>T?F[1]:F[0],f=n.getPixelFromCoordinate(d))}}return h&&(f=[Math.round(f[0]),Math.round(f[1])]),{snapped:h,vertex:d,vertexPixel:f}},p.prototype.updateFeature_=function(e){this.removeFeature(e,!1),this.addFeature(e,!1)},p.prototype.writeCircleGeometry_=function(e,t){for(var r=(0,u.fromCircle)(t).getCoordinates()[0],n=0,i=r.length-1;n<i;++n){var s=r.slice(n,n+2),a={feature:e,segment:s};this.rBush_.insert((0,o.boundingExtent)(s),a)}},p.prototype.writeGeometryCollectionGeometry_=function(e,t){for(var r=t.getGeometriesArray(),n=0;n<r.length;++n){var i=this.SEGMENT_WRITERS_[r[n].getType()];i&&i(e,r[n])}},p.prototype.writeLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length-1;n<i;++n){var s=r.slice(n,n+2),a={feature:e,segment:s};this.rBush_.insert((0,o.boundingExtent)(s),a)}},p.prototype.writeMultiLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length;n<i;++n)for(var s=r[n],a=0,u=s.length-1;a<u;++a){var l=s.slice(a,a+2),h={feature:e,segment:l};this.rBush_.insert((0,o.boundingExtent)(l),h)}},p.prototype.writeMultiPointGeometry_=function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length;n<i;++n){var o=r[n],s={feature:e,segment:[o,o]};this.rBush_.insert(t.getExtent(),s)}},p.prototype.writeMultiPolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length;n<i;++n)for(var s=r[n],a=0,u=s.length;a<u;++a)for(var l=s[a],h=0,d=l.length-1;h<d;++h){var f=l.slice(h,h+2),g={feature:e,segment:f};this.rBush_.insert((0,o.boundingExtent)(f),g)}},p.prototype.writePointGeometry_=function(e,t){var r=t.getCoordinates(),n={feature:e,segment:[r,r]};this.rBush_.insert(t.getExtent(),n)},p.prototype.writePolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length;n<i;++n)for(var s=r[n],a=0,u=s.length-1;a<u;++a){var l=s.slice(a,a+2),h={feature:e,segment:l};this.rBush_.insert((0,o.boundingExtent)(l),h)}},p}(l.default),m=y;exports.default=m;"},"sourceMaps":null,"error":null,"hash":"6cb10d44d2f7e42c8e69a1ccd41a8abd","cacheData":{"env":{}}}